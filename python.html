<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>python</title>
    <style>
        h1{font: bolder italic 40px '微软雅黑';}
        div{width: 600px;
            color: slateblue;
            font: bolder italic 15px '微软雅黑';}
        #h4{font: bolder italic 20px '微软雅黑';}
    </style>
</head>
<body>
    <h1>python脚本语言</h1>
    <ol type="1">
        <li id='h4'>字符串：一组有序，不可变的，可重复的数据</li>
            <div>
                <ul type='square'>
                    <li>ord(x);把字符编码成整数</li>
                    <li>chr(x);把编码转换成对应的字符</li>
                    <li>encode(x);把str编码成bytes</li>
                    <li>decode(x)把bytes解码成str</li>
                    <li>len(x);长度</li>
                    <li>split();把字符串转换为列表</li>
                    <li>join();把列表转换为字符串</li>
                    <li>%s;字符串替换</li>
                    <li>replace(x);字符串替换</li>
                    <li>%d;整数替换</li>
                    <li>%f;浮点数替换</li>
                    <li>%x;十六进制整数替换</li>
                </ul>
            </div>
        <li  id='h4'>列表：一组有序，可变的，可重复的数据</li>
            <div>
                <ul type='square'>
                    <li>[x];索引</li>
                    <li>[x:y];切片</li>
                        <ol type="I">
                            <li>[:x];前x个元素</li>
                            <li>[-x:];后x个元素</li>
                            <li>[::x];每隔x取一个元素</li>
                        </ol>
                    <li>append(x);末尾插入</li>
                    <li>len(x);长度</li>
                    <li>pop(x);末尾删除</li>
                    <li>insert(num,x);指定插入</li>
                    <li>pop(num);指定删除</li>
                </ul>
            </div>
        <li  id='h4'>元组：一组有序，不可变，可重复的数据</li>
            <div>
                <ul type='square'>
                    <li>[x];索引</li>
                    <li>[x;y];切片</li>
                    <li>len(x);长度</li>
                </ul>
            </div>
        <li  id='h4'>字典:一组无序，可变的，可重复的键值对数据</li>
            <div>
                <ul type='square'>
                    <li>get('key');检查是否存在</li>
                    <li>pop('key');删除字典</li>
                    <li>items();以列表返回可遍历的(键, 值)元组数组</li>
                </ul>
            </div>
        <li  id='h4'>集合：一组无序，不重复的数据</li>
            <div>
                <ul type='square'>
                    <li>x=set();空集合</li>
                    <li>add(x);插入元素</li>
                    <li>len(x);长度</li>
                    <li>update(x);插入列表、元组、字典</li>
                    <li>remove(x);删除元素，没有元素就报错</li>
                    <li>discard(x);删除元素，没有也不会报错</li>
                    <li>s1&s2;集合交集</li>
                    <li>s1|s2;集合并集</li>
                    <li>s1-s2;集合差集</li>
                    <li>pop();随机删除元素</li>
                    <li>clear();清空元素</li>
                </ul>
            </div>
        <li  id='h4'>条件判断</li>
            <div>
                <pre>
                    x = 5
                    if x<3:
                        print('小')
                    elif x>5:
                        print('中')
                    else:
                        print('大')
                </pre>
            </div>
        <li  id='h4'>循环</li>
            <div>
                <ul type='square'>
                    <li>range(x);生成整数序列</li>
                    <li>enumerate(x);同时获取index，value值</li>
                    <li>break;终止循环</li>
                    <li>continue;跳过当前循环，继续下一次循环</li>
                    <li>for循环</li>
                        <ol type="A">
                            <li>字符串遍历</li>
                                <pre>
                                    x='abcd'
                                    for i in x:
                                        print(i)
                                </pre>
                            <li>列表遍历</li>
                                <pre>
                                    x=[1,2,3,4]
                                    for i in x:
                                        print(i)
                                </pre>
                            <li>元组遍历</li>
                                <pre>
                                    x=(1,2,3,4)
                                    for i in x:
                                        print(i)
                                </pre>
                            <li>字典遍历</li>
                                <pre>
                                    x={'name':'wowo',
                                        'age':'23'}
                                    for i,n in x.items():
                                        print(i,n)
                                </pre>
                        </ol>
                    <li>while循环</li>
                        <pre>
                            x=0
                            while x<10:
                                x=x+1
                                print(x)
                        </pre>
                </ul>
            </div>
        <li  id='h4'>函数</li>
            <div>
                <ul type='square'>
                    <li>函数定义</li>
                        <pre>
                            def test():
                                x='a'
                                print(x)
                            test()
                        </pre>
                    <li>return;返回函数结果</li>
                        <pre>
                            def test():
                                x='a'
                                return x
                            test()
                        </pre>
                    <li>位置参数</li>
                        <pre>
                            def test(x):
                                print(x)
                            test(2)
                        </pre>
                    <li>默认值参数</li>
                        <pre>
                            def test(x,y=3):
                                print(x)
                                print(y)
                            test(2)
                        </pre>
                    <li>可变参数</li>
                        <pre>
                            def test(*x):
                                for i in x:
                                    print(i)
                            list=[1,2,3,4]
                            test(*list)
                        </pre>
                    <li>关键字参数</li>
                        <pre>
                            def test(**x):
                                for i,n in x.items():
                                    print(i,n)
                            dict={'name':'wowo','age':'22'}
                            test(**dict)
                        </pre>
                    <li>递归函数</li>
                        <pre>
                            def test(x):
                                    if x==1:
                                            return 1
                                    return x*test(x-1)
                            print(test(3))
                        </pre>
                    <li>函数式编程</li>
                        <ol type="A">
                            <li>高阶函数</li>
                                <ol type="i">
                                    <li>一个函数可以接收另一个函数作为参数</li>
                                        <pre>
                                            def test(x,y,f):
                                                    return f(x)+f(y)
                                            print(test(-2,3,abs))
                                        </pre>
                                    <li>把序列全部作用到一个函数上</li>
                                        <pre>
                                            x=map(str,[1,2,3,4,5])
                                            print(list(x))
                                        </pre>
                                    <li>reduce(x,list);把一个函数作用到一个序列上，但这个函数必须接收两个参数</li>
                                        <pre>
                                            from functools import reduce
                                            def test(x,y):
                                                    return x+y
                                            print(reduce(test,[1,2,3,4]))
                                        </pre>
                                    <li>filter();把传入的函数依次作用于每个元素</li>
                                        <pre>
                                            def test(x):
                                                    return x % 2==1
                                            print(list(filter(test,[1,2,3,4])))
                                        </pre>
                                    <li>sorted();list排序</li>
                                        <pre>
                                            x=sorted([14,3,-4,-7],key=abs)
                                            print(x)    
                                        </pre>
                                </ol>
                            <li>返回函数：函数作为返回值(闭包——相关参数和变量都保存在返回的函数中)</li>
                                <pre>
                                    def test():
                                            def index():
                                                    return 3
                                            return index
                                    x=test()
                                    y=x()
                                    print(y)
                                </pre>
                            <li>lambda;匿名函数(没有函数名)</li>
                                <pre>
                                    x=lambda x:x*x
                                    print(x(5))
                                </pre>
                            <li>装饰器：在代码运行期间动态增加功能的方式</li>
                            <li>partial;偏函数(定义加调用)</li>
                                <pre>
                                    from functools import partial
                                    x=partial(int,base=2)
                                    print(x('100'))
                                </pre>
                        </ol>
                    <li>常用内置函数</li>
                        <ol type="A">
                            <li>print();打印</li>
                            <li>input();输入</li>
                            <li>abs(x);返回绝对值</li>
                            <li>max(x,y,z);返回最大值</li>
                            <li>hex(x);整数转换为16进制的字符串</li>
                            <li>isinstance();检查数据类型</li>
                            <li>lower();转换为小写</li>
                            <li>sum();求和</li>
                        </ol>
                </ul>
            </div>
        <li  id='h4'>类</li>
        <li  id='h4'>模块</li>
        <li  id='h4'>面向对象</li>
        <li  id='h4'>IO编程</li>
            <div>
                <ul type='square'>
                    <li>StringIO();将str写入内存中</li>
                        <pre>
                            from io import StringIO
                            x=StringIO()
                            x.write('abc')
                            print(x.getvalue())
                        </pre>
                    <li>BytesIO();将二进制写入内存中</li>
                        <pre>
                            from io import BytesIO
                            y=BytesIO()
                            y.write('中文'.encode('utf-8'))
                            print(y.getvalue())
                        </pre>
                    <li>文件写入</li>
                        <ol type='i'>
                            <li>a;表示追加写入</li>
                            <li>w;表示覆盖写入</li>
                            <li>x;创建写入</li>
                            <li>wb;表示写入二进制数据</li>
                            <li>write();写入字符串</li>
                            <li>writelines();写入列表</li>
                                <pre>
                                    f=open('test.txt','a',encoding='utf-8')
                                    f.write('abc')
                                    f.close()
                                </pre>
                        </ol>
                    <li>文件读出</li>
                        <ol type='i'>
                            <li>r;表示读取</li>
                            <li>rb;表示读取二进制数据</li>
                            <li>read();把数据读取为一个字符串</li>
                            <li>readline();只读取一行数据</li>
                            <li>readlines();把数据按行读取到一个列表中</li>
                            <pre>
                                f=open('test.txt','r',encoding='utf-8')
                                x=f.read()
                                print(x)
                                f.close()
                            </pre>
                        </ol>
                    <li>os模块</li>
                        <ol type="i">
                            <li>os.name;查看系统(posix(linux、unix、mac),nt(windows))</li>
                            <li>os.environ.get('path');查看某个环境变量</li>
                            <li>os.getpid();查看进程pid</li>
                            <li>os.path.abspath('.');查看当前目录的绝对路径</li>
                            <li>os.getcwd();查看当前文件路径</li>
                            <li>os.system(x);执行cmd命令</li>
                            <li>os.path.join(path);申请目录</li>
                            <li>os.mkdir(path);创建目录</li>
                            <li>os.rmdir(path);删除目录</li>
                            <li>os.path.split(path);拆分目录</li>
                            <li>os.path.splitext(path);查看文件扩展名</li>
                            <li>os.rename(path_x,path_y);文件重命名</li>
                            <li>os.remove(path);删除文件</li>
                            <li>os.listdir(path);查看目录中所有文件</li>
                        </ol>
                    <li>pickle模块</li>
                        <ol type="i">
                            <li>pickle.dumps(x);把一个对象bytes序列化</li>
                            <li>pickle.loads(y);把bytes序列化再反序列化</li>
                            <li>pickle.dump(x,z);把对象bytes序列化到一个file-like-object中(z表示打开的文件)</li>
                            <li>pickle.load(z);把文件中的bytes序列化再反序列化</li>
                        </ol>
                    <li>json模块</li>
                        <ol type='i'>
                            <li>json.dumps(x);把一个对象json序列化</li>
                            <li>json.loads(y);把json序列化再反序列化</li>
                            <li>json.dump(x,z);把对象json序列化到一个file-like-object中(z表示打开的文件)</li>
                            <li>json.load(z);把文件中的json序列化再反序列化</li>
                        </ol>
                </ul>
            </div>
        <li  id='h4'>进程与线程</li>
        <li  id='h4'>常用三方包</li>
            <div>
                <ul type='square'>
                    <li>数据处理</li>
                        <ol type='A'>
                            <li>xlsxwriter模块</li>
                                <pre>
                                    import xlsxwriter
                                    workbook = xlsxwriter.Workbook(r'test.xlsx') #创建xlsx文件
                                    worksheet = workbook.add_worksheet('Sheet1') #在xlsx文件中创建Sheet1表格
                                    worksheet.write('A1','数据') #往单元格A1中写入数据
                                    worksheet.set_column('A','B',30) #设置AB列之间的列宽
                                    workbook.close() #关闭xlsx文件
                                </pre>
                            <li>xlrd模块</li>
                                <pre>
                                    import xlrd
                                    workbook=xlrd.open_workbook(r'test.xlsx')   #指定读取的xlsx文件
                                    worksheet=workbook.sheet_by_name('Sheet1')  #指定读取xlsx文件中的Sheet1表
                                    col_one=worksheet.col_values(0) #读取sheet1中的第一列
                                    row_one=worksheet.row_values(0) #读取sheet1中的第一行
                                    col_row=worksheet.row_values(0)[3]  #读取sheet1中的第一行第三列
                                </pre>
                            <li>openpyxl模块</li>
                                <pre>
                                    workbook=load_workbook(r'test.xlsx')    #指定读取的xlsx文件
                                    worksheet= workbook['Sheet1']   #指定读取的xlsx文件中的Sheet1表
                                    worksheet.column_dimensions['A'].width = 20 #设置列宽
                                    worksheet.row_dimensions[0].height = 30 #设置行高
                                    worksheet [A1 ].alignment = Alignment(horizontal='center', vertical='center')   #设置文本居中
                                    worksheet [A1 ].alignment = Alignment(wrap_text=True)   #设置自动换行
                                    worksheet.cell(1,1).value = '测试'  #文字写入
                                    worksheet.cell(1,1).value #文字读取
                                    workbook.save() #保存xlsx文件
                                </pre>
                            <li>dicttoxml模块</li>
                                <pre>
                                    import dicttoxml
                                    json={"name":"wowo","sex":"1"}  #定义字典
                                    xml=dicttoxml.dicttoxml(json,root=False,attr_type=False)    #字典转换为xml
                                    print(xml)
                                </pre>
                            <li>xmltodict模块</li>
                                <pre>
                                    import xmltodict
                                    import json
                                    xml=xmltodict.parse('&lt;span&gt;hello&lt;/span&gt;') #xml转换为dict
                                    json=json.dumps(xml)
                                    print(json)
                                </pre>
                        </ol>
                    <li>数据提取</li>
                        <ol type="A">
                            <li>re模块</li>
                                <img src=".img/re.png" alt="操作符">
                                <li>re.compile();将正则表达式的字符串形式编译成正则表达式对象</li>
                                    <pre>
                                        import re
                                        x=re.compile(r'[1-9]\d{5}')
                                    </pre>
                                <li>re.search();在一个字符串中搜索匹配正则表达式的第一个位置(返回match对象)</li>
                                    <pre>
                                        import re
                                        x=re.compile(r'[1-9]\d{5}')
                                        y=x.search('BIT100081 100084TSU')
                                        print(y.group())
                                    </pre>
                                <li>re.match();从一个字符串的开始位置起匹配正则表达式</li>
                                    <pre>
                                        import re
                                        x=re.compile(r'[1-9]\d{5}')
                                        y=x.match('100081BIT 100084TSU')
                                        print(y.group())
                                    </pre>
                                <li>re.findall;搜索字符串，以列表类型返回全部能匹配的子串</li>
                                    <pre>
                                        import re
                                        x=re.compile(r'[1-9]\d{5}')
                                        y=x.findall('100081BIT 100084TSU')
                                        print(y)
                                    </pre>
                                <li>re.split();将一个字符串按照正则表达式匹配结果进行分隔，返回列表类型</li>
                                    <pre>
                                        import re
                                        x=re.compile(r'[1-9]\d{5}')
                                        y=x.split('BIT100081 TSU100084',maxsplit=1)
                                        print(y)
                                    </pre>
                                <li>re.finditer();搜索字符串，返回一个匹配结果的迭代类型(每个迭代元素是match对象)</li>
                                    <pre>
                                        import re
                                        x=re.compile(r'[1-9]\d{5}')
                                        for i in x.finditer('BIT100081 TSU100084'):
                                            print(i.group())
                                    </pre>
                                <li>re.sub();在一个字符串中替换所有匹配正则表达式的字符串，返回替换后的字符串</li>
                                    <pre>
                                        import re
                                        x=re.compile(r'[1-9]\d{5}')
                                        y=x.sub(':hello',"BIT100081 TSU100084")
                                        print(y)
                                    </pre>
                            <li>bs4模块</li>
                                <ul type='square'>
                                    <li>soup=BeautifulSoup(html,'html.parser');html.parser是一个html的解释器</li>   
                                    <li>soup.prettify();获取解析后的html</li>
                                    <li>soup.title;获取解析后的html标题</li>
                                    <li>soup.findAll(x);获取解析后的html中的所有x标签</li>
                                    <li>soup.findAll(attribute='y');获取解析后的html中的所有含y属性的标签</li>
                                    <li>soup.findAll(string='z');获取解析后的html中的标签之间能匹配z的文本</li>
                                    <li>soup.x.string;获取解析后的html中的x标签之间的文本</li>
                                </ul>
                        </ol>
                </ul>
            </div>
        <li id='h4'>mitmdump抓包</li>
            <div>
                <ul type='square'>
                    <li>mitmdump  -w  outfile；抓取数据写入文件</li>
                    <li>mitmdump  -s   script.py；执行过滤脚本</li>
                    <li>过滤请求</li>
                        <pre>
                            from mitmproxy import http,ctx
                            def request(flow):
                                print(flow.request.host)        #host标头值
                                print(flow.request.url)         #请求的url地址
                                print(flow.request.scheme)      #请求的协议
                                print(flow.request.port)        #请求的端口
                                print(flow.request.method)      #请求的方法
                                print(flow.request.headers)     #请求的头信息
                                print(flow.request.cookies)     #请求cookies
                                print(flow.request.get_text())  #请求body   
                        </pre>
                    <li>过滤响应</li>
                        <pre>
                            from mitmproxy import http,ctx
                            def response(flow):

                                print(flow.repsonse.status_code)    #响应状态码
                                print(flow.request.headers)         #响应头信息
                                print(flow.repsonse.cookies)        #响应cookies
                                print(flow.response.text)           #响应内容

                        </pre>
                </ul>
            </div>
        <li id='h4'>GUI自动化</li>
            <div>
                <ul type='square'>
                    <li>pyautogui.FAILSAFE=False;保护措施，鼠标放于（0，0）即可主动引发错误，中断执行中的脚本</li>
                    <li>pyautogui.size();获取屏幕分辨率</li>
                    <li>pyautogui.position();获取当前鼠标的位置</li>
                    <li>根据像素截图并保存</li>
                        <pre>
                            import pyautogui
                            img=pyautogui.screenshot(region=(x1,y1,x2,y2))
                            img.save(test.png)
                        </pre>
                    <li>根据像素获取图片中的颜色</li>      
                        <pre>
                            import pyautogui
                            img=pyautogui.screenshot(region=(x1,y1,x2,y2))
                            color=img.getpixel(x,y)
                            print(color)
                        </pre>
                    <li>pyautogui.moveTo(x,y,z);像素以左上角为原点进行移动(z表示鼠标移动速度)</li>
                    <li>pyautogui.moveRel(x,y,z);像素以当前位置为原点进行移动(z表示鼠标移动速度)</li>
                    <li>pyautogui.locateCenterOnScreen('test.png');根据图片获取图片中心像素</li>
                    <li>pyautogui.dragTo(x,y,z);像素以左上角为原点进行拖拽(z表示鼠标移动速度)</li>
                    <li>pyautogui.dragRel(x,y,z);像素以当前位置为原点进行拖拽(z表示鼠标移动速度)</li>
                    <li>pyautogui.typewrite(['x'],y);执行单个按键(x为键盘码，y为执行速度)/li>
                    <li>pyautogui.hotkey('x','y')执行组合按键</li>
                </ul>
            </div>
        <li id='h4'>图形界面</li>   
        <li id='h4'>定时器</li>
            <div>
                <pre>
                    import schedule
                    name = 'wowo'
                    def job(name):
                        print('her name is: %s' % name)
                    #每隔二秒钟执行一次任务
                    schedule.every(2).seconds.do(job, name)   
                    #每隔二分钟执行一次任务
                    schedule.every(2).minutes.do(job, name)  
                    #每隔一小时执行一次任务 
                    schedule.every(1).hour.do(job, name) 
                    #每天的10:30执行一次任务  
                    schedule.every().day.at("10:30").do(job, name)   
                    #每隔5到10天执行一次任务
                    schedule.every(5).to(10).days.do(job, name) 
                    #每周一的这个时候执行一次任务  
                    schedule.every().monday.do(job, name) 
                    #每周三13:15执行一次任务  
                    schedule.every().wednesday.at("13:15").do(job, name)   
                    while True:
                        #run_pending：运行所有可以运行的任务
                        schedule.run_pending()   
                </pre>
            </div>
        <li id='h4'>网络编程</li>
        <li id='h4'>电子邮箱</li>
            <div>
                <ul type='square'>
                    <li>发送纯文本</li>
                        <pre>
                            import smtplib
                            from email import encoders
                            from email.header import Header
                            from email.mime.text import MIMEText
                            from email.mime.multipart import MIMEMultipart
                            from email.utils import parseaddr, formataddr
                            class Smtp():
                                #格式化邮箱地址
                                def format_addr(self,x):
                                    name, addr = parseaddr(x)
                                    return formataddr((Header(name, 'utf-8').encode(), addr))
                                def send_mail(self,x):
                                    #发送邮箱
                                    user='xxxxxxxxxxxxx'
                                    #qq邮箱登录授权码
                                    password='xxxxxxxxxxxxx'
                                    #接受邮箱
                                    user_to='xxxxxxxxxxxx'
                                    #邮件对象
                                    msg = MIMEMultipart()
                                    # 邮件正文是MIMEText:
                                    msg.attach(MIMEText('%s'% x, 'plain', 'utf-8'))
                                    msg['From'] = Smtp().format_addr('徐铃纹 <%s>' % user)
                                    msg['To'] = Smtp().format_addr('管理员 <%s>' % user_to)
                                    msg['Subject'] = Header('来自测试部————徐……', 'utf-8').encode()
                                    #SMTP——qq邮箱服务器地址
                                    stmp_server='smtp.qq.com'
                                    server=smtplib.SMTP(stmp_server,25)
                                    #打印和SMTP服务器交互的信息
                                    server.set_debuglevel(1)
                                    #login()方法用来登录SMTP服务器
                                    server.login(user,password)
                                    #sendmaill()方法用来发邮件，[]表示可以发送多个人
                                    #as_string()方法用来把MIMEText对象变成str
                                    server.sendmail(user,[user_to],msg.as_string())
                                    server.quit()
                        </pre>
                    <li>发送附件</li>
                        <pre>
                            import smtplib
                            from email import encoders
                            from email.header import Header
                            from email.mime.text import MIMEText
                            from email.mime.multipart import MIMEMultipart
                            from email.utils import parseaddr, formataddr
                            class Smtp():
                            # 格式化邮箱地址
                            def format_addr(self,x):
                                name, addr = parseaddr(x)
                                return formataddr((Header(name, 'utf-8').encode(), addr))
                            def send_mail(self,local_file):
                                # 发送邮箱
                                user='xxxxxxxxxx'
                                # qq邮箱登录授权码
                                password='xxxxxxxxxxx'
                                # 接受邮箱
                                user_to='8xxxxxxxxxx'
                                # 邮件对象
                                msg = MIMEMultipart()
                                # 邮件正文是MIMEText:
                                msg.attach(MIMEText('send with file...', 'plain', 'utf-8'))
                                msg['From'] = Smtp().format_addr('徐铃纹 <%s>' % user)
                                msg['To'] = Smtp().format_addr('管理员 <%s>' % user_to)
                                msg['Subject'] = Header('来自测试部————徐……', 'utf-8').encode()
                                # 构造附件
                                att1 = MIMEText(open('%s' % local_file, 'rb').read(), 'base64', 'utf-8')
                                att1["Content-Type"] = 'application/octet-stream'
                                # 这里的filename可以任意写，写什么名字，邮件中显示什么名字
                                att1["Content-Disposition"] = 'attachment; filename= %s' %  local_file
                                msg.attach(att1)
                                # SMTP——qq邮箱服务器地址
                                stmp_server='smtp.qq.com'
                                server=smtplib.SMTP(stmp_server,25)
                                # 打印和SMTP服务器交互的信息
                                server.set_debuglevel(1)
                                # login()方法用来登录SMTP服务器
                                server.login(user,password)
                                # sendmaill()方法用来发邮件，[]表示可以发送多个人
                                # as_string()方法用来把MIMEText对象变成str
                                server.sendmail(user,[user_to],msg.as_string())
                                server.quit()
                        </pre>
                </ul>
            </div>
        <li id='h4'>访问数据库</li>
            <div>
                <ul type='square'>
                    <li>sqlite3</li>
                        <pre>
                            import sqlite3
                            #与数据库建立连接
                            conn = sqlite3.connect('sql.db')
                            #创建游标
                            cursor = conn.cursor()
                            #执行sql语句
                            cursor.execute('create table user(id varchar(20) primary key,name varchar(20))')
                            cursor.execute('insert into user(id,name) values(001,"wowo")')
                            cursor.execute('select * from user')
                            #获取查询结果集
                            values = cursor.fetchall()
                            print(values)
                            #获得插入行数
                            cursor.rowcount
                            #关闭游标
                            cursor.close()
                            #提交事务
                            conn.commit()
                            #关闭连接
                            conn.close()
                        </pre>
                    <li>Pymysql</li>
                        <pre>
                            import pymysql
                            #与数据库建立连接
                            conn = pymysql.connect('localhost','root','root','test')
                            #创建游标
                            cursor = conn.cursor()
                            #执行sql语句
                            cursor.execute('create table user(id varchar(20) primary key,name varchar(20))')
                            cursor.execute('insert into user(id,name) values(001,"wowo")')
                            cursor.execute('select * from user')
                            #获取查询结果集
                            values = cursor.fetchall()
                            print(values)
                            #获得插入行数
                            cursor.rowcount
                            #关闭游标
                            cursor.close()
                            #提交事务
                            conn.commit()
                            #关闭连接
                            conn.close()
                        </pre>
                        
                </ul>
            </div>
        <li id='h4'>负载测试</li>
            <div>
                <ul type='square'>
                    <pre>
                        from locust import HttpLocust,TaskSet,task
                        #定义用户行为
                        class Test(TaskSet):
                            #用户执行权重(数值越大,执行频率越高)
                            @task(1)
                            def test(self):
                                self.client.get('/')
                        class Start(HttpLocust):
                            #指向用户行为
                            task_set = Test
                            #负载任务之间执行的最小等待时间(ms)
                            min_wait = 3000
                            #负载任务之间执行的最大等待时间(ms)
                            max_wait = 6000
                            #指向负载ip
                            host = 'http://192.168.199.207:32768'
                    </pre>
                    <li>locust -f test.py;启动GUI模式，浏览器输入http:localhost:8089打开GUI</li>
                    <li>locust –f test.py –-no-web –c 10 –r 2 –t 1m –-csv=D:\report</li>
                        <ol type="A">
                            <li>–-no-web;表示不使用web界面运行测试</li>
                            <li>-c;表示设置虚拟用户数</li>
                            <li>-r;设置每秒启动虚拟用户数</li>
                            <li>-t;设置运行时间（h/m/s）</li>
                            <li>--csv;表示csv测试报告生成位置</li>
                        </ol>
                </ul>
            </div>
        <li id='h4'>自动化测试框架</li>
            <div>
                <ul type='square'>
                    <li>unittest框架</li>
                        <ol type="A">
                            <li>定义用例</li>
                            <li>测试文件必须以test开头</li>
                            <li>测试函数必须以test开头</li>
                                <pre>
                                    import unittest
                                    class Test(unittest.TestCase):
                                        #环境初始化
                                        def setUp(self):
                                            print(1)
                                        def tearDown(self):
                                            print(3)
                                        def test_001(self):
                                            print(2)
                                    if __name__ == "__main__":
                                        unittest.main()    
                                </pre>
                            <li>运行测试集</li>
                                <pre>
                                    import unittest
                                    from HTMLTestRunner import HTMLTestRunner 
                                    #收集测试用例
                                    test_suite=unittest.defaultTestLoader.discover(r'./testcase',pattern='test*.py'
                                    #定义测试文件
                                    file_z = open(r"test.html",mode='wb')
                                    #定义测试报告对象
                                    runner = HTMLTestRunner(stream=file_z,title='WUCRM接口测试报告',description='用例执行情况')
                                    #运行测试集
                                    runner.run(test_suite)
                                </pre>
                        </ol> 
                    <li>pytest框架</li>
                        <ol type="A">
                            <li>fixtrue定义的文件名必须是conftest.py,测试函数继承生效</li>
                            <li>@pytest.fixtrue(scope="session");表示全局初始化一次</li>
                            <li>@pytest.fixtrue(scope="module");表示一个模块只初始化一次</li>
                            <li>@pytest.fixtrue(scope="function");表示每个function都初始化一次</li>
                                <pre>
                                    from py._xmlgen import html
                                    import pytest
                                    # 添加接口地址与项目名称
                                    def pytest_configure(config):
                                        config._metadata["项目名称"] = "name"
                                        config._metadata['测试地址'] = 'url'
                                    # 添加所属部门与测试人员
                                    @pytest.mark.optionalhook
                                    def pytest_html_results_summary(prefix):
                                        prefix.extend([html.p("所属部门: 测试部")])
                                        prefix.extend([html.p("测试人员: wowo")])
                                    @pytest.fixture(scope='session')    
                                    def headers_x():
                                        token='test'
                                        return token
                                </pre>
                            <li>测试文件必须以test_开头或结尾</li>
                            <li>测试函数必须以test_*或*_test</li>
                            <li>测试类中不能定义__init__方法</li>
                            <li>@pytest.mark.parametrize();用例参数化</li>
                            <li>pytest相关插件</li>
                                <ol type="i">
                                    <li>pytest-selenium;集成selenium</li>
                                    <li>pytest-allure-adaptor;</li>
                                    <li>pytest-sugar;优化运行效果</li>
                                    <li>pytest-rerunfailures;重新运行错误用例</li>
                                    <li>pytest-xdist;多cpu分发分布式执行</li>
                                    <li>pytest-html;测试报告</li>
                                </ol>
                        </ol>
                </ul>
            </div>
        <li id='h4'>scrapy爬虫</li>
            <div>
                <ul type='square'>
                    <li>scrapy startproject scrapy_namae；创建scrapy项目</li>
                    <li>scrapy genspider -t spider_template spider_name spider_url；使用模块创建spider</li>
                    <li>scrapy list；查看所有spider</li>
                    <li>scrapy view url；用浏览器打开url</li>
                    <li>scrapy fetch url；获取url的响应</li>
                    <li>scrapy bench spider_name；检查蜘蛛的爬取速度</li>
                    <li>scrapy check spider_name；检查蜘蛛的配置</li>
                    <li>scrapy runspider spider_file；运行一个spider</li>
                    <li>scrapy crowl spider_name；按项目配置运行一个spider</li>
                </ul>
            </div>
        <li id='h4'>web开发</li>
            <div>
                <li>Flask框架</li>
                    <pre>
                        from flask import Flask
                        app=Flask(__name__)
                        #定义路由
                        @app.route('/index')
                        def index():
                            html="&lt;div&gt; hello world &lt;/div&gt;"
                            return html
                        if __name__=='__main__':
                            #开启调试服务器
                            app.run(debug=True)
                    </pre>
            </div>
        <li id='h4'>异步io</li>
        
    </ol>
</body>
</html>